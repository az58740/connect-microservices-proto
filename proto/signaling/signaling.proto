syntax = "proto3";

package signaling.v1;

option go_package = "github.com/az58740/connect-microservices-proto/golang/signaling;signaling";

enum SignalType {
  SIGNAL_TYPE_UNSPECIFIED = 0;
  SIGNAL_TYPE_OFFER = 1;
  SIGNAL_TYPE_ANSWER = 2;
  SIGNAL_TYPE_CANDIDATE = 3;
  SIGNAL_TYPE_LEAVE = 4;
  SIGNAL_TYPE_CHAT = 5;
}

service SignalingService {
  rpc JoinRoom(JoinRoomRequest) returns (stream SignalMessage);
  rpc SendSignal(SignalMessage) returns (Empty);
  rpc LeaveRoom(LeaveRoomRequest) returns (Empty);

}

message JoinRoomRequest {
  string room_id = 1;
  string user_id = 2;
  string user_name=3;
}

message SignalMessage {
  string room_id = 1;
  string from_user = 2;
  string from_user_name = 3;
  string to_user = 4;
  string to_user_name = 5;
  SignalType type = 6; // offer | answer | ice |chat
  string payload = 7; // SDP or ICE json
    string message = 8; // متن چت یا اعلان
}


message LeaveRoomRequest {
  string room_id = 1;
  string user_id = 2;
}


message Empty {}
